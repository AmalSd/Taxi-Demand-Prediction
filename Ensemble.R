
#Sliding window Ensemble function
#Output : prediction for the considered time period pr
#Input:  pr: considered time period for the pediction
#         H: size of the sliding window
#       pred1,2,3: prediction generated by the three baseline models

calculensemble=function(H,pr,pred1,pred2,pred3){
  
  rtest1=sapply(1:H, function(y)pred1[(pr-H-1+y)])
  xtest=sapply(1:H, function(y) Demand[(pr-H-1+y)])
  rtest2=sapply(1:H, function(y)pred2[(pr-H-1+y)])
  rtest3=sapply(1:H, function(y)pred3[(pr-H-1+y)])
  
  ro1=sum(abs(rtest1-xtest)/(rtest1+xtest+1))/H
  ro2=sum(abs(rtest2-xtest)/(rtest2+xtest+1))/H
  ro3=sum(abs(rtest3-xtest)/(rtest3+xtest+1))/H
  gama=(1-ro1)+(1-ro2)+(1-ro3)
  r=round((pred1[pr]*(1-ro1)+pred2[pr]*(1-ro2)+pred3[pr]*(1-ro3))/gama)
  return(r)
  
}


